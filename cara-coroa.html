<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Simulador: Cara ou Coroa</title>
  <style>
    :root{
      --bg: #0f172a;        /* slate-900 */
      --panel: #111827;     /* gray-900 */
      --panel-2: #0b1222;   
      --text: #e5e7eb;      /* gray-200 */
      --muted: #9ca3af;     /* gray-400 */
      --accent: #22c55e;    /* green-500 */
      --accent-2: #3b82f6;  /* blue-500 */
      --danger: #ef4444;    /* red-500 */
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
    }

    *{ box-sizing: border-box }
    html,body{ height:100% }
    body{
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 800px at 70% -10%, #1f2937 0%, var(--bg) 45%);
      color:var(--text);
      display:grid; place-items:center; padding:24px;
    }

    .app{
      width: min(980px, 100%);
      display:grid; gap:20px;
      grid-template-columns: 1.2fr .8fr;
    }

    @media (max-width: 880px){
      .app{ grid-template-columns: 1fr; }
    }

    .card{
      background: linear-gradient(180deg, var(--panel) 0%, var(--panel-2) 100%);
      border: 1px solid rgba(255,255,255,.06);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      padding: 20px;
    }

    .header{ display:flex; align-items:center; justify-content:space-between; gap:16px; }
    .title{ font-size: clamp(22px, 2.3vw, 28px); font-weight: 800; letter-spacing:.2px }
    .subtitle{ color:var(--muted); font-size:14px }

    .controls{ display:flex; gap:12px; flex-wrap:wrap; align-items:center }
    button{
      appearance:none; border:0; cursor:pointer; padding:12px 16px; border-radius:12px; font-weight:700;
      background: var(--accent-2); color:white; transition: transform .06s ease, filter .2s ease, background .2s;
    }
    button:hover{ filter:brightness(1.08) }
    button:active{ transform: translateY(1px) }
    button.secondary{ background: #374151 }
    button.danger{ background: var(--danger) }
    button:disabled{ opacity:.6; cursor:not-allowed }

    .grid{ display:grid; grid-template-columns: 1fr 1fr; gap:20px }
    @media (max-width: 560px){ .grid{ grid-template-columns: 1fr } }

    /* Coin Scene */
    .scene{ perspective: 1200px; display:grid; place-items:center; height: 360px; }

    .coin{
      position: relative; width: 180px; height: 180px; border-radius: 50%;
      transform-style: preserve-3d; transition: transform 1s ease;
      box-shadow: 0 12px 30px rgba(0,0,0,.45), inset 0 0 0 2px rgba(255,255,255,.08);
    }

    .coin::after{
      content:""; position:absolute; inset:0; border-radius:50%;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.15), transparent 40%),
                  radial-gradient(circle at 70% 70%, rgba(0,0,0,.25), transparent 45%);
      mix-blend-mode: overlay; pointer-events:none;
    }

    .face{
      position:absolute; inset:0; display:grid; place-items:center; border-radius:50%;
      font-weight:900; font-size: 44px; letter-spacing:.5px;
      backface-visibility: hidden; color:#0b1222;
      background: radial-gradient(circle at 50% 40%, #f3f4f6, #cbd5e1 70%, #94a3b8 100%);
      border: 6px solid #cbd5e1;
    }
    .face small{ display:block; color:#111827; font-size:13px; font-weight:800; margin-top:6px }

    .back{ transform: rotateY(180deg); }

    /* ring */
    .edge{
      position:absolute; inset: -6px; border-radius:50%;
      background: conic-gradient(from 0deg,
        #6b7280 0 10%, #9ca3af 10% 20%, #e5e7eb 20% 30%,
        #9ca3af 30% 40%, #6b7280 40% 50%, #9ca3af 50% 60%,
        #e5e7eb 60% 70%, #9ca3af 70% 80%, #6b7280 80% 90%, #9ca3af 90% 100%);
      filter: blur(.3px);
      z-index:-1;
    }

    /* Animation states */
    .coin.spin{ animation: spin 1200ms cubic-bezier(.2,.8,.2,1) forwards; }
    @keyframes spin{
      0%   { transform: rotateY(0) rotateX(0) translateZ(0) }
      55%  { transform: rotateY(720deg) rotateX(18deg) translateZ(6px) }
      100% { transform: rotateY(var(--final-rot)) rotateX(0) translateZ(0) }
    }

    .stats{ display:grid; grid-template-columns: repeat(4, 1fr); gap:12px; }
    @media (max-width: 560px){ .stats{ grid-template-columns: repeat(2, 1fr) } }
    .pill{
      padding:12px; border-radius:12px; background:#0b1222; border:1px solid rgba(255,255,255,.06);
    }
    .pill .k{ font-size:12px; color:var(--muted) }
    .pill .v{ font-size:22px; font-weight:800 }

    .history{ display:flex; gap:8px; flex-wrap:wrap; align-items:center; min-height: 40px }
    .tag{ padding:8px 10px; background:#0b1222; border:1px solid rgba(255,255,255,.08); border-radius:999px; font-weight:700; font-size:13px }

    .range{
      display:grid; gap:8px; align-items:center;
    }
    .range input{ width:100% }
    .hint{ color:var(--muted); font-size:12px }

    .footer{ color:var(--muted); font-size:12px; text-align:center; margin-top:10px }
    .kbd{ background:#111827; padding:2px 6px; border-radius:6px; border:1px solid rgba(255,255,255,.08) }
  </style>
</head>
<body>
  <div class="app">
    <section class="card" style="grid-column: span 1 / span 1">
      <div class="header">
        <div>
          <div class="title">Simulador: Cara ou Coroa</div>
          <div class="subtitle">Clique em <strong>Lan√ßar</strong> ou use <span class="kbd">Barra de Espa√ßo</span>.</div>
        </div>
        <div class="controls">
          <button id="btnFlip">üé≤ Lan√ßar</button>
          <button class="secondary" id="btnReset">‚Ü∫ Resetar</button>
        </div>
      </div>

      <div class="scene" aria-live="polite" aria-atomic="true">
        <div class="coin" id="coin" aria-label="Moeda">
          <div class="edge" aria-hidden="true"></div>
          <div class="face front">CARA <small>üáßüá∑</small></div>
          <div class="face back">COROA <small>‚òÖ</small></div>
        </div>
      </div>

      <div class="grid">
        <div class="card">
          <div class="stats">
            <div class="pill"><div class="k">Total</div><div class="v" id="sTotal">0</div></div>
            <div class="pill"><div class="k">Caras</div><div class="v" id="sHeads">0</div></div>
            <div class="pill"><div class="k">Coroas</div><div class="v" id="sTails">0</div></div>
            <div class="pill"><div class="k">% Caras</div><div class="v" id="sPct">0%</div></div>
          </div>
          <div class="footer">Dica: pressione <span class="kbd">R</span> para resetar.</div>
        </div>
        <div class="card">
          <div class="range">
            <label for="bias"><strong>Vi√©s de Probabilidade</strong> ‚Äî chance de sair <strong>Cara</strong>: <span id="biasLabel">50%</span></label>
            <input id="bias" type="range" min="0" max="100" value="50" />
            <div class="hint">0% = sempre Coroa ‚Ä¢ 50% = justo ‚Ä¢ 100% = sempre Cara</div>
          </div>
          <div style="margin-top:12px; display:flex; gap:8px; flex-wrap:wrap">
            <button id="btnFair" class="secondary">Modo Justo (50%)</button>
            <button id="btnBiasHeads" class="secondary">Vi√©s Cara (70%)</button>
            <button id="btnBiasTails" class="secondary">Vi√©s Coroa (30%)</button>
          </div>
        </div>
      </div>

      <div class="card">
        <strong>Hist√≥rico</strong>
        <div id="history" class="history" aria-label="Hist√≥rico de resultados"></div>
      </div>

    </section>

    <aside class="card" style="grid-column: span 1 / span 1">
      <h3 style="margin-top:0">Como funciona</h3>
      <p style="color:var(--muted); line-height:1.6">
        Quando voc√™ clica em <em>Lan√ßar</em>, o script aplica uma rota√ß√£o 3D na moeda e escolhe um resultado com base no 
        valor do controle de vi√©s (0‚Äì100). Estat√≠sticas e hist√≥rico s√£o atualizados imediatamente.
      </p>
      <ul style="color:var(--muted); line-height:1.6">
        <li><strong>Acess√≠vel</strong>: mensagens ARIA e atalhos de teclado (<span class="kbd">Espa√ßo</span> / <span class="kbd">R</span>).</li>
        <li><strong>Sem depend√™ncias</strong>: funciona apenas com HTML, CSS e JS puros.</li>
        <li><strong>Persist√™ncia opcional</strong>: ative <code>USE_LOCAL_STORAGE</code> no JS para guardar estat√≠sticas.</li>
      </ul>
      <hr style="border-color: rgba(255,255,255,.08)"/>
      <div class="footer">Feito com carinho üíö ‚Äî personalize textos/cores √† vontade.</div>
    </aside>
  </div>

  <script>
    // ===== Config =====
    const USE_LOCAL_STORAGE = false; // mude para true se quiser persistir as estat√≠sticas no navegador

    // ===== Estado =====
    const state = {
      total: 0,
      heads: 0,
      tails: 0,
      last: null,
      bias: 50, // chance de CARA em %
      spinning: false,
    };

    // ===== Elementos =====
    const el = {
      coin: document.getElementById('coin'),
      btnFlip: document.getElementById('btnFlip'),
      btnReset: document.getElementById('btnReset'),
      sTotal: document.getElementById('sTotal'),
      sHeads: document.getElementById('sHeads'),
      sTails: document.getElementById('sTails'),
      sPct: document.getElementById('sPct'),
      history: document.getElementById('history'),
      bias: document.getElementById('bias'),
      biasLabel: document.getElementById('biasLabel'),
      btnFair: document.getElementById('btnFair'),
      btnBiasHeads: document.getElementById('btnBiasHeads'),
      btnBiasTails: document.getElementById('btnBiasTails'),
    };

    // ===== Util =====
    function save(){ if(!USE_LOCAL_STORAGE) return; localStorage.setItem('coinState', JSON.stringify(state)); }
    function load(){ if(!USE_LOCAL_STORAGE) return; try{ Object.assign(state, JSON.parse(localStorage.getItem('coinState'))||{}); }catch(e){} }

    function updateUI(){
      el.sTotal.textContent = state.total;
      el.sHeads.textContent = state.heads;
      el.sTails.textContent = state.tails;
      const pct = state.total ? Math.round((state.heads/state.total)*100) : 0;
      el.sPct.textContent = pct + '%';
      el.bias.value = state.bias;
      el.biasLabel.textContent = state.bias + '%';
    }

    function addHistory(tag){
      const span = document.createElement('span');
      span.className = 'tag';
      span.textContent = tag;
      el.history.prepend(span);
      const limit = 30;
      while(el.history.children.length > limit){ el.history.removeChild(el.history.lastChild); }
    }

    function pickResult(){
      const r = Math.random()*100; // 0..100
      return (r < state.bias) ? 'CARA' : 'COROA';
    }

    function flip(){
      if(state.spinning) return;
      state.spinning = true;
      el.btnFlip.disabled = true;
      el.btnReset.disabled = true;

      const result = pickResult();
      // Defina a rota√ß√£o final: 0deg para CARA (frente), 180deg para COROA (verso)
      const finalRot = (result === 'CARA') ? 0 : 180;
      el.coin.style.setProperty('--final-rot', finalRot + 'deg');

      // Force reflow para reiniciar anima√ß√£o quando clicar r√°pido
      void el.coin.offsetWidth;
      el.coin.classList.remove('spin');
      el.coin.classList.add('spin');

      // Quando a anima√ß√£o terminar, atualiza estado
      el.coin.addEventListener('animationend', onEnd, { once: true });
      function onEnd(){
        state.total++;
        if(result==='CARA') state.heads++; else state.tails++;
        state.last = result;
        updateUI();
        addHistory(result === 'CARA' ? 'CARA' : 'COROA');
        save();
        el.btnFlip.disabled = false;
        el.btnReset.disabled = false;
        state.spinning = false;
      }
    }

    function reset(){
      if(state.spinning) return;
      state.total = state.heads = state.tails = 0; state.last = null; el.history.innerHTML='';
      save(); updateUI();
    }

    // ===== Eventos =====
    el.btnFlip.addEventListener('click', flip);
    el.btnReset.addEventListener('click', reset);

    el.bias.addEventListener('input', (e)=>{ state.bias = parseInt(e.target.value,10); el.biasLabel.textContent = state.bias + '%'; save(); });
    el.btnFair.addEventListener('click', ()=>{ state.bias = 50; updateUI(); save(); });
    el.btnBiasHeads.addEventListener('click', ()=>{ state.bias = 70; updateUI(); save(); });
    el.btnBiasTails.addEventListener('click', ()=>{ state.bias = 30; updateUI(); save(); });

    // Atalhos de teclado
    document.addEventListener('keydown', (e)=>{
      if(e.code === 'Space'){ e.preventDefault(); flip(); }
      if(e.key.toLowerCase() === 'r'){ reset(); }
    });

    // Init
    load();
    updateUI();
  </script>
</body>
</html>
